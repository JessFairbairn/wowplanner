<!DOCTYPE html>
<html>
<head>
	<title>Wow Planner!</title>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
	<!-- <script type="text/javascript" src="../angularjs/angular.min.js"></script> -->
	<script src="app.js"></script>
	<script src="services/WowTask.js"></script>
	<script src="angular-local-storage.js"></script>
	<script src="nonAngular.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-animate.min.js"></script>
	<link rel="stylesheet" type="text/css" href="main.css"/>
	<link rel="stylesheet" type="text/css" href="theme.css"/>
	<link href='https://fonts.googleapis.com/css?family=Oxygen' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body ng-app="wowApp" ng-controller="wowController as wowCtrl">
<div id="modal" ng-show="isModalVisible()" ng-click="modalClick();"></div>
<div id="mainWrapper">
	<div id="filterDiv">
		<h1>Wow Planner</h1>
		<label><input type="radio" name="activeFilter" ng-model="activeFilter" ng-value="filters.all">All Tasks</label><br>
		<label><input type="radio" name="activeFilter" ng-model="activeFilter" ng-value="filters.dueToday">Due Today</label>
		<br>
		<fieldset>
			<legend>Tags</legend>
			<div ng-repeat="(key, value) in tagMap | orderBy:(key)" class=row>
				<input type="checkbox" ng-model="tagMap[key]" ng-attr-id="{{'toggleTag' + $index}}">
				<label ng-attr-for="{{'toggleTag' + $index}}">{{key}}</label>
			</span>
		</fieldset>
		<br><br>
		<button ng-click="debugMode = !debugMode;">Toggle Debugging</button>
		<button ng-click="scopeDump()" ng-show="debugMode">Scope Dump</button>
		<button ng-click="localStorageDump()" ng-show="debugMode">Local Storage Dump</button>
	</div>

	<div id="mainArea">
		<div id="addTaskDiv">
			<input type="text" ng-model="newTask.title" ng-keydown="returnKeyOverride($event,addTask);" placeholder="Add a task...">
			<button type="button" ng-click="addTask()">Add Task</button>
		</div>
		<ul id="taskList">
			<wow-task-li  ng-repeat="task in tasks | filter:activeFilter | filter: {isComplete:false} |filter:tagFilter | orderBy:recursiveTaskOrder"/>
		</ul>
		<button ng-click="showCompleted = !showCompleted" type="button">
			Show/Hide Completed Tasks
		</button>
		<div id="completedTasks" ng-show="showCompleted">
			<h3>Completed Tasks</h3>
			<ul id="taskList">
				<wow-task-li  ng-repeat="task in tasks | filter:activeFilter | filter: {isComplete:true}"/>
			</ul>
		</div>
		<menu type="context" id="taskCtxMenu">
			<menuitem label="Delete" onclick="deleteTaskExternal(event);"/>
		</menu>
	</div>
</div>

<div id="taskEditorDiv" ng-class="{taskEditorHidden:!selectedTask}">
	
	<div class="row">
		<button type="button" ng-click="closeTaskEditor();">Close</button>
		<input ng-model="selectedTask.title" />
	</div>
	<div class="row">
		<label>Deadline<input type="date" ng-model="selectedTask.deadline"></label>
	</div>
	<div class="row">
		<label>Importance<input type="range" ng-model="selectedTask.priority" min="1" max="5"></label>
	</div>
	<div class="row">
		<fieldset>
			<legend>Tags</legend>
			<span ng-repeat="tag in selectedTask.tags">
				{{tag}}<button type="button" ng-click="selectedTask.RemoveTag(tag)">X</button>
			</span>
		</fieldset>
	</div>
	<div class="row">
		<label>Add Tag<input ng-model="selectedTask.newTag" type="text" list="taskEditorTagList">
		</label>
		<button type="button" ng-click="selectedTask.AddTag();" ng-keyup="returnKeyOverride($event,selectedTask.AddTag);">+</button>
		<datalist id="taskEditorTagList">
			<option ng-repeat="(key,value) in tagMap">{{key}}</option>
		</datalist>
	</div>
	<div class="row">
		<!-- /*Dependant on...*/ -->
		<label>Prerequisites</label>
		<select multiple="multiple" ng-model="selectedTask.prerequisites" 
			ng-options="prereqTask.ID as prereqTask.title for prereqTask in tasks | filter: {isComplete: false}">
		</select>
	</div>
	<div class="row" ng-show="debugMode">	
		<button ng-click="taskDump()">Task Dump</button>
	</div>
</div>

</body>
</html>